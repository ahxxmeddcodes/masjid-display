<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Masjid Display</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f2f1e6;
      color: #582f0c;
      height: 100vh;
      margin: 0;
      overflow: hidden;

      /* Center the main display and create a safe area for TVs / kiosk browsers */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .screen {
      display: flex;
      flex-direction: row;

      /* Use a slightly smaller area than the full viewport to avoid edges being cut off
         on TVs and in Fully Kiosk, while still filling most of the screen on desktops. */
      width: 96vw;
      height: 96vh;
      max-width: 1920px;
      max-height: 1080px;
    }

    /* LEFT SIDE: MASJID + PRAYER TIMES */

    .left {
      width: 35%;
      padding: 36px 40px 40px 40px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      background: #f2f1e6;
      border-right: 1px solid rgba(51, 65, 85, 0.7);
    }

    .header-block {
      margin-bottom: 20px;
    }

    .date-card {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 16px;
      background: #f2f1e6;
      border: 1px solid #582f0c;
      box-shadow: 0 10px 26px rgba(88,47,12,0.2);
    }

    .masjid-name {
      font-size: 2.2rem;
      font-weight: 700;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: #000000;
    }

    .masjid-tagline {
      font-size: 1.1rem;
      color: #000000;
      margin-top: 4px;
    }

    .current-date {
      margin-top: 12px;
      font-size: 1.2rem;
      color: #000000;
    }

    .current-time {
      margin-top: 6px;
      font-size: 2.4rem;
      font-weight: 700;
      color: #000000;
    }

    .prayer-card {
      margin-top: 24px;
      padding: 16px 14px;
      border-radius: 18px;
      background: #f2f1e6;
      box-shadow: 0 14px 40px rgba(88,47,12,0.25);
    }

    .widget-box {
      margin-top: 10px;
      padding: 6px;
      border-radius: 10px;
      background: #f2f1e6;
      box-shadow: 0 4px 12px rgba(88,47,12,0.12);
      max-height: 250px;
      overflow: hidden;
    }

    .prayer-card-title {
      font-size: 1.4rem;
      font-weight: 700;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      color: #000000;
    }

    .method-text {
      font-size: 1rem;
      color: #000000;
      margin-bottom: 12px;
    }

    .next-badge {
      font-size: 0.7rem;
      color: #000000;
      border-radius: 999px;
      border: 1px solid #582f0c;
      padding: 2px 8px;
      display: inline-block;
      box-shadow: 0 0 18px #582f0c;
    }

    .prayer-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .prayer-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      border-radius: 10px;
      background: #f2f1e6;
      border: 1px solid #582f0c;
      font-size: 1.35rem;
      color: #000000;
    }

    .prayer-row-label {
      font-weight: 700;
      font-size: 1.35rem;
    }

    .prayer-row-time {
      font-variant-numeric: tabular-nums;
      font-weight: 700;
      font-size: 1.35rem;
      text-align: right;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      line-height: 1.15;
    }

    .prayer-row-time .iqamah-label {
      text-align: right;
    }

    .prayer-row.next {
      background: #f2f1e6;
      border-color: #582f0c;
    }

    .prayer-row.current-glow {
      border: 1px solid #582f0c;
      box-shadow: 0 0 22px #582f0c;
    }

    .next-prayer-panel {
      margin-top: 16px;
      padding: 12px 14px;
      border-radius: 16px;
      background: #f2f1e6;
      border: 1px solid #582f0c;
      box-shadow: 0 0 22px #582f0c;
    }

    .next-prayer-label {
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-weight: 600;
      margin-bottom: 4px;
      color: #000000;
    }

    .next-prayer-text {
      margin-top: 6px;
      font-size: 1.2rem;
      font-weight: 700;
      color: #000000;
    }

    .next-prayer-countdown {
      margin-top: 8px;
      margin-bottom: 4px;
      font-size: 2.5rem;
      font-weight: 700;
      color: #000000;
    }

    .iqamah-label {
      font-size: 0.7em;
      font-weight: 500;
      display: block;
      margin-top: 2px;
    }

    .footer {
      margin-top: 18px;
      font-size: 1rem;
      color: #000000;
    }

    /* RIGHT SIDE: SLIDESHOW */

    .right {
      width: 65%;
      padding: 20px 24px;
      display: flex;
      flex-direction: column;
      background: #f2f1e6;
      position: relative;
    }

   .quran-widget {
  padding: 8px 12px;
  border-radius: 16px;
  background: #f2f1e6;
  border: 1px solid #582f0c;
  box-shadow: 0 0 22px #582f0c;
} 

    .quran-label {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .quran-ayah {
      font-size: 1.4rem;
      font-weight: 500;
      margin-bottom: 2px;
    }

    .quran-ref {
      font-size: 0.8rem;
      color: #555555;
    }

    .slide-frame {
      width: 100%;
      flex: 1;
      margin-top: 10px;
      margin-bottom: 10px;
      border-radius: 26px;
      overflow: hidden;
      background: #f2f1e6;
      box-shadow: 0 18px 50px rgba(88,47,12,0.25);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .slide-frame img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: opacity 0.6s ease-in-out;
      opacity: 1;
    }

    .slide-frame img.fade-out {
      opacity: 0;
    }

    .slide-dots {
      margin-top: 8px;
      display: flex;
      justify-content: center;
      gap: 6px;
    }

    .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      border: 1px solid #582f0c;
      background: transparent;
    }

    .dot.active {
      background: #582f0c;
      border-color: #582f0c;
    }

    @media (max-width: 900px) {
      .screen {
        flex-direction: column;
      }
      .left, .right {
        width: 100%;
        height: 50vh;
      }
    }
  </style>
</head>
<body>
  <div class="screen">
    <!-- LEFT PANEL -->
    <div class="left">
      <div>
        <div class="header-block">
          <div class="masjid-name" id="masjidName">Masjid An Nur</div>
          <div class="date-card">
            <div class="current-date" id="currentDate"></div>
            <div class="current-time" id="currentTime"></div>
          </div>
        </div>

        <div class="prayer-card">
          <div class="prayer-card-title">
            <span>Today's Prayer Times</span>
          </div>
          <div class="method-text" id="methodText">Loading prayer times…</div>
          <div class="prayer-list" id="prayerList">
            <!-- Filled by JavaScript -->
          </div>
        </div>

        <div class="next-prayer-panel">
          <div class="next-prayer-label">Countdown to Next Prayer</div>
          <div class="next-prayer-countdown" id="nextPrayerCountdown">--:--:--</div>
          <div class="next-prayer-text" id="nextPrayerPanel">Loading...</div>
        </div>

        <div class="footer">
          This display is managed by Masjid An Nur, please see brother Ahmed for suggestions and feedback.
        </div>
      </div> <!-- end inner wrapper in left -->
    </div> <!-- end .left -->

    <!-- RIGHT PANEL -->
    <div class="right">
      <div class="quran-widget">
        <div class="quran-label">Qur'an Reminder</div>
        <div class="quran-ayah" id="quranAyah"></div>
        <div class="quran-ref" id="quranRef"></div>
      </div>
      <div class="slide-frame">
        <img id="slideImage" src="" alt="Masjid announcement slide" />
      </div>
      <div class="slide-dots" id="slideDots"></div>
      <div class="widget-box" id="widgetBox">
        <script src="https://elfsightcdn.com/platform.js" async></script>
        <div class="elfsight-app-ddda69fe-8123-465f-baab-168e90473277" data-elfsight-app-lazy></div>
      </div>
    </div>
  </div>

  <script>
    /****************************************
     * CONFIGURATION
     ****************************************/

    // Change these to your own details
    const MASJID_NAME = "Masjid An Nur";
    const CITY = "Lithonia";
    const COUNTRY = "United States";
    // 2 = ISNA (common for North America). Change if your masjid uses a different method.
    const CALC_METHOD = 2;

    // Slides folder and files (relative to this HTML file)
   const SLIDES = [
  "slides/about us.jpg",
  "slides/review.jpg",
  "slides/quran class.jpg",
  "slides/donate.jpg",
  "slides/latest khutbah.jpg",
  "slides/previous khutbahs.jpg",
  "slides/khutbah topic.jpg",
  "slides/join group.jpg"
  // Add more file paths here
];

    // Time each slide is shown (in milliseconds)
    const SLIDE_DURATION = 20000; // 20 seconds

    // Qur'an verses to rotate through on the right panel
    const QURAN_VERSES = [
      {
        text: "Indeed, in the remembrance of Allah do hearts find rest.",
        ref: "Surah Ar-Ra'd 13:28"
      },
      {
        text: "So remember Me; I will remember you. And be grateful to Me and do not deny Me.",
        ref: "Surah Al-Baqarah 2:152"
      },
      {
        text: "And whoever relies upon Allah - then He is sufficient for him.",
        ref: "Surah At-Talaq 65:3"
      },
      {
        text: "So which of the favors of your Lord would you deny?",
        ref: "Surah Ar-Rahman 55:13"
      },
      {
        text: "And whoever fears Allah - He will make for him a way out.",
        ref: "Surah At-Talaq 65:2"
      },
      {
        text: "Allah does not burden a soul beyond that it can bear.",
        ref: "Surah Al-Baqarah 2:286"
      },
      {
        text: "Indeed, with hardship [will be] ease.",
        ref: "Surah Ash-Sharh 94:6"
      },
      {
        text: "So be patient. Indeed, the promise of Allah is truth.",
        ref: "Surah Ar-Rum 30:60"
      },
      {
        text: "And establish prayer for My remembrance.",
        ref: "Surah Ta-Ha 20:14"
      },
      {
        text: "Indeed, prayer prohibits immorality and wrongdoing.",
        ref: "Surah Al-Ankabut 29:45"
      },
      {
        text: "And whoever does good deeds, whether male or female, while being a believer - those will enter Paradise.",
        ref: "Surah An-Nisa 4:124"
      },
      {
        text: "O you who have believed, respond to Allah and to the Messenger when he calls you to that which gives you life.",
        ref: "Surah Al-Anfal 8:24"
      },
      {
        text: "And whoever is grateful, his gratitude is only for [the benefit of] himself.",
        ref: "Surah Luqman 31:12"
      },
      {
        text: "And your Lord says, Call upon Me; I will respond to you.",
        ref: "Surah Ghafir 40:60"
      },
      {
        text: "Unquestionably, by the remembrance of Allah hearts find rest.",
        ref: "Surah Ar-Ra'd 13:28"
      },
      {
        text: "And whoever does righteous deeds, whether male or female, while being a believer - We will surely give them a good life.",
        ref: "Surah An-Nahl 16:97"
      },
      {
        text: "Indeed, Allah loves the doers of good.",
        ref: "Surah Al-Baqarah 2:195"
      },
      {
        text: "And seek help through patience and prayer.",
        ref: "Surah Al-Baqarah 2:45"
      },
      {
        text: "So be mindful of Allah as much as you are able.",
        ref: "Surah At-Taghabun 64:16"
      },
      {
        text: "And whoever puts his trust in Allah, then He will suffice him.",
        ref: "Surah At-Talaq 65:3"
      },
      {
        text: "And whoever comes to Him as a believer having done righteous deeds - for those will be the highest degrees.",
        ref: "Surah Ta-Ha 20:75"
      },
      {
        text: "Say, Indeed, my prayer, my sacrifice, my living and my dying are for Allah, Lord of the worlds.",
        ref: "Surah Al-An'am 6:162"
      },
      {
        text: "So race to [all that is] good.",
        ref: "Surah Al-Baqarah 2:148"
      },
      {
        text: "Indeed, Allah is with the patient.",
        ref: "Surah Al-Baqarah 2:153"
      },
      {
        text: "And whoever turns away from My remembrance - indeed, he will have a depressed life.",
        ref: "Surah Ta-Ha 20:124"
      }
    ];

    /****************************************
     * CLOCK (DATE + TIME)
     ****************************************/

    function updateClock() {
      const now = new Date();

      const dateOptions = {
        weekday: "long",
        year: "numeric",
        month: "long",
        day: "numeric"
      };
      const timeOptions = {
        hour: "numeric",
        minute: "2-digit",
        hour12: true
      };

      const dateStr = now.toLocaleDateString(undefined, dateOptions);
      const timeStr = now.toLocaleTimeString(undefined, timeOptions);

      const dateEl = document.getElementById("currentDate");
      const timeEl = document.getElementById("currentTime");

      if (dateEl) dateEl.textContent = dateStr;
      if (timeEl) timeEl.textContent = timeStr;
    }

    setInterval(updateClock, 1000);
    updateClock();

    /****************************************
     * YEAR‑ROUND PRAYER SCHEDULE (Editable)
     ****************************************/

    const PRAYER_SCHEDULE = [
      /* JANUARY (31 days) */
      { month:1, from:"01-01", to:"01-07",
  fajr:"06:29", iq_fajr:"06:41",
  dhuhr:"12:43", iq_dhuhr:"12:58",
  asr:"15:25", iq_asr:"15:40",
  maghrib:"17:43", iq_maghrib:"17:45",
  isha:"18:57", iq_isha:"19:12"
},
     { month:1, from:"01-08", to:"01-14",
  fajr:"06:29", iq_fajr:"06:41",
  dhuhr:"12:46", iq_dhuhr:"13:01",
  asr:"15:31", iq_asr:"15:46",
  maghrib:"17:50", iq_maghrib:"17:52",
  isha:"19:03", iq_isha:"19:18"
},
      { month:1, from:"01-15", to:"01-21",
  fajr:"06:29", iq_fajr:"06:39",
  dhuhr:"12:48", iq_dhuhr:"13:03",
  asr:"15:37", iq_asr:"15:52",
  maghrib:"17:57", iq_maghrib:"17:59",
  isha:"19:09", iq_isha:"19:24"
},
      { month:1, from:"01-22", to:"01-31",
  fajr:"06:28", iq_fajr:"06:39",
  dhuhr:"12:50", iq_dhuhr:"13:05",
  asr:"15:46", iq_asr:"16:01",
  maghrib:"18:07", iq_maghrib:"18:09",
  isha:"19:18", iq_isha:"19:33"
},

      /* FEBRUARY (29 days for safety, works for 28 too) */
      { month:2, from:"02-01", to:"02-07",
  fajr:"06:23", iq_fajr:"06:33",
  dhuhr:"12:51", iq_dhuhr:"13:06",
  asr:"15:51", iq_asr:"16:06",
  maghrib:"18:14", iq_maghrib:"18:16",
  isha:"19:24", iq_isha:"19:39"
},
      { month:2, from:"02-08", to:"02-14",
  fajr:"06:18", iq_fajr:"06:27",
  dhuhr:"12:51", iq_dhuhr:"13:06",
  asr:"15:56", iq_asr:"16:11",
  maghrib:"18:20", iq_maghrib:"18:22",
  isha:"19:30", iq_isha:"19:45"
},
      { month:2, from:"02-15", to:"02-21",
  fajr:"06:12", iq_fajr:"06:21",
  dhuhr:"12:51", iq_dhuhr:"13:06",
  asr:"16:00", iq_asr:"16:15",
  maghrib:"18:26", iq_maghrib:"18:28",
  isha:"19:35", iq_isha:"19:50"
},
      { month:2, from:"02-22", to:"02-29",
  fajr:"06:05", iq_fajr:"06:13",
  dhuhr:"12:51", iq_dhuhr:"13:06",
  asr:"16:05", iq_asr:"16:20",
  maghrib:"18:33", iq_maghrib:"18:35",
  isha:"19:42", iq_isha:"19:57"
},

      /* MARCH (31 days) */
{ month:3, from:"03-01", to:"03-07",
  fajr:"05:56", iq_fajr:"06:04",
  dhuhr:"12:49", iq_dhuhr:"13:04",
  asr:"16:08", iq_asr:"16:23",
  maghrib:"18:38", iq_maghrib:"18:40",
  isha:"19:47", iq_isha:"20:02"
},

{ month:3, from:"03-08", to:"03-14",
  fajr:"06:47", iq_fajr:"06:55",
  dhuhr:"13:48", iq_dhuhr:"14:03",
  asr:"17:10", iq_asr:"17:25",
  maghrib:"19:45", iq_maghrib:"19:47",
  isha:"20:53", iq_isha:"21:08"
},

{ month:3, from:"03-15", to:"03-21",
  fajr:"06:38", iq_fajr:"06:46",
  dhuhr:"13:46", iq_dhuhr:"14:01",
  asr:"17:12", iq_asr:"17:27",
  maghrib:"19:50", iq_maghrib:"19:52",
  isha:"20:59", iq_isha:"21:14"
},

{ month:3, from:"03-22", to:"03-31",
  fajr:"06:28", iq_fajr:"06:37",
  dhuhr:"13:44", iq_dhuhr:"13:59",
  asr:"17:14", iq_asr:"17:29",
  maghrib:"19:57", iq_maghrib:"19:59",
  isha:"21:07", iq_isha:"21:22"
},

      /* APRIL (30 days) */
{ month:4, from:"04-01", to:"04-07",
  fajr:"06:14", iq_fajr:"06:23",
  dhuhr:"13:41", iq_dhuhr:"13:56",
  asr:"17:15", iq_asr:"17:30",
  maghrib:"20:03", iq_maghrib:"20:05",
  isha:"21:13", iq_isha:"21:28"
},

{ month:4, from:"04-08", to:"04-14",
  fajr:"06:03", iq_fajr:"06:14",
  dhuhr:"13:39", iq_dhuhr:"13:54",
  asr:"17:16", iq_asr:"17:31",
  maghrib:"20:08", iq_maghrib:"20:10",
  isha:"21:20", iq_isha:"21:35"
},

{ month:4, from:"04-15", to:"04-21",
  fajr:"05:53", iq_fajr:"06:05",
  dhuhr:"13:37", iq_dhuhr:"13:52",
  asr:"17:16", iq_asr:"17:31",
  maghrib:"20:13", iq_maghrib:"20:15",
  isha:"21:26", iq_isha:"21:41"
},

{ month:4, from:"04-22", to:"04-30",
  fajr:"05:44", iq_fajr:"05:57",
  dhuhr:"13:35", iq_dhuhr:"13:50",
  asr:"17:16", iq_asr:"17:31",
  maghrib:"20:20", iq_maghrib:"20:22",
  isha:"21:35", iq_isha:"21:50"
},

      /* MAY (31 days) */
{ month:5, from:"05-01", to:"05-07",
  fajr:"05:32", iq_fajr:"05:47",
  dhuhr:"13:34", iq_dhuhr:"13:49",
  asr:"17:17", iq_asr:"17:32",
  maghrib:"20:25", iq_maghrib:"20:27",
  isha:"21:42", iq_isha:"21:57"
},

{ month:5, from:"05-08", to:"05-14",
  fajr:"05:24", iq_fajr:"05:41",
  dhuhr:"13:34", iq_dhuhr:"13:49",
  asr:"17:17", iq_asr:"17:32",
  maghrib:"20:31", iq_maghrib:"20:33",
  isha:"21:49", iq_isha:"22:04"
},

{ month:5, from:"05-15", to:"05-21",
  fajr:"05:17", iq_fajr:"05:35",
  dhuhr:"13:34", iq_dhuhr:"13:49",
  asr:"17:18", iq_asr:"17:33",
  maghrib:"20:36", iq_maghrib:"20:38",
  isha:"21:56", iq_isha:"22:11"
},

{ month:5, from:"05-22", to:"05-31",
  fajr:"05:11", iq_fajr:"05:31",
  dhuhr:"13:35", iq_dhuhr:"13:50",
  asr:"17:19", iq_asr:"17:34",
  maghrib:"20:42", iq_maghrib:"20:44",
  isha:"22:04", iq_isha:"22:19"
},

      /* JUNE (30 days) */
{ month:6, from:"06-01", to:"06-07",
  fajr:"05:05", iq_fajr:"05:27",
  dhuhr:"13:36", iq_dhuhr:"13:51",
  asr:"17:20", iq_asr:"17:35",
  maghrib:"20:46", iq_maghrib:"20:48",
  isha:"22:09", iq_isha:"22:24"
},

{ month:6, from:"06-08", to:"06-14",
  fajr:"05:03", iq_fajr:"05:25",
  dhuhr:"13:37", iq_dhuhr:"13:52",
  asr:"17:22", iq_asr:"17:37",
  maghrib:"20:49", iq_maghrib:"20:51",
  isha:"22:12", iq_isha:"22:27"
},

{ month:6, from:"06-15", to:"06-21",
  fajr:"05:03", iq_fajr:"05:26",
  dhuhr:"13:39", iq_dhuhr:"13:54",
  asr:"17:23", iq_asr:"17:38",
  maghrib:"20:51", iq_maghrib:"20:53",
  isha:"22:15", iq_isha:"22:30"
},

{ month:6, from:"06-22", to:"06-30",
  fajr:"05:07", iq_fajr:"05:29",
  dhuhr:"13:41", iq_dhuhr:"13:56",
  asr:"17:25", iq_asr:"17:40",
  maghrib:"20:52", iq_maghrib:"20:54",
  isha:"22:15", iq_isha:"22:30"
},

      /* JULY (31 days) */
{ month:7, from:"07-01", to:"07-07",
  fajr:"05:11", iq_fajr:"05:32",
  dhuhr:"13:42", iq_dhuhr:"13:57",
  asr:"17:27", iq_asr:"17:42",
  maghrib:"20:51", iq_maghrib:"20:53",
  isha:"22:15", iq_isha:"22:30"
},

{ month:7, from:"07-08", to:"07-14",
  fajr:"05:17", iq_fajr:"05:36",
  dhuhr:"13:43", iq_dhuhr:"13:58",
  asr:"17:27", iq_asr:"17:42",
  maghrib:"20:50", iq_maghrib:"20:52",
  isha:"22:12", iq_isha:"22:27"
},

{ month:7, from:"07-15", to:"07-21",
  fajr:"05:23", iq_fajr:"05:41",
  dhuhr:"13:44", iq_dhuhr:"13:59",
  asr:"17:28", iq_asr:"17:43",
  maghrib:"20:48", iq_maghrib:"20:50",
  isha:"22:09", iq_isha:"22:24"
},

{ month:7, from:"07-22", to:"07-31",
  fajr:"05:32", iq_fajr:"05:48",
  dhuhr:"13:44", iq_dhuhr:"13:59",
  asr:"17:28", iq_asr:"17:43",
  maghrib:"20:44", iq_maghrib:"20:46",
  isha:"22:04", iq_isha:"22:19"
},

      /* AUGUST (31 days) */
{ month:8, from:"08-01", to:"08-07",
  fajr:"05:39", iq_fajr:"05:53",
  dhuhr:"13:43", iq_dhuhr:"13:58",
  asr:"17:27", iq_asr:"17:42",
  maghrib:"20:37", iq_maghrib:"20:39",
  isha:"21:47", iq_isha:"22:02"
},

{ month:8, from:"08-08", to:"08-14",
  fajr:"05:45", iq_fajr:"05:58",
  dhuhr:"13:43", iq_dhuhr:"13:58",
  asr:"17:25", iq_asr:"17:40",
  maghrib:"20:30", iq_maghrib:"20:32",
  isha:"21:46", iq_isha:"22:01"
},

{ month:8, from:"08-15", to:"08-21",
  fajr:"05:52", iq_fajr:"06:03",
  dhuhr:"13:41", iq_dhuhr:"13:56",
  asr:"17:23", iq_asr:"17:38",
  maghrib:"20:23", iq_maghrib:"20:25",
  isha:"21:37", iq_isha:"21:52"
},

{ month:8, from:"08-22", to:"08-31",
  fajr:"06:00", iq_fajr:"06:10",
  dhuhr:"13:40", iq_dhuhr:"13:55",
  asr:"17:19", iq_asr:"17:34",
  maghrib:"20:15", iq_maghrib:"20:17",
  isha:"21:27", iq_isha:"21:42"
},

      /* SEPTEMBER (30 days) */
{ month:9, from:"09-01", to:"09-07",
  fajr:"06:06", iq_fajr:"06:14",
  dhuhr:"13:37", iq_dhuhr:"13:52",
  asr:"17:13", iq_asr:"17:28",
  maghrib:"20:02", iq_maghrib:"20:04",
  isha:"21:12", iq_isha:"21:27"
},

{ month:9, from:"09-08", to:"09-14",
  fajr:"06:12", iq_fajr:"06:19",
  dhuhr:"13:35", iq_dhuhr:"13:50",
  asr:"17:08", iq_asr:"17:23",
  maghrib:"19:53", iq_maghrib:"19:55",
  isha:"21:02", iq_isha:"21:17"
},

{ month:9, from:"09-15", to:"09-21",
  fajr:"06:17", iq_fajr:"06:24",
  dhuhr:"13:32", iq_dhuhr:"13:47",
  asr:"17:03", iq_asr:"17:18",
  maghrib:"19:43", iq_maghrib:"19:45",
  isha:"20:52", iq_isha:"21:07"
},

{ month:9, from:"09-22", to:"09-30",
  fajr:"06:23", iq_fajr:"06:30",
  dhuhr:"13:30", iq_dhuhr:"13:45",
  asr:"16:56", iq_asr:"17:11",
  maghrib:"19:33", iq_maghrib:"19:35",
  isha:"20:41", iq_isha:"20:56"
},

      /* OCTOBER (31 days) */
{ month:10, from:"10-01", to:"10-07",
  fajr:"06:29", iq_fajr:"06:35",
  dhuhr:"13:27", iq_dhuhr:"13:42",
  asr:"16:48", iq_asr:"17:03",
  maghrib:"19:21", iq_maghrib:"19:23",
  isha:"20:29", iq_isha:"20:44"
},

{ month:10, from:"10-08", to:"10-14",
  fajr:"06:34", iq_fajr:"06:40",
  dhuhr:"13:24", iq_dhuhr:"13:39",
  asr:"16:42", iq_asr:"16:57",
  maghrib:"19:12", iq_maghrib:"19:14",
  isha:"20:20", iq_isha:"20:35"
},

{ month:10, from:"10-15", to:"10-21",
  fajr:"06:39", iq_fajr:"06:46",
  dhuhr:"13:23", iq_dhuhr:"13:38",
  asr:"16:35", iq_asr:"16:50",
  maghrib:"19:03", iq_maghrib:"19:05",
  isha:"20:11", iq_isha:"20:26"
},

{ month:10, from:"10-22", to:"10-31",
  fajr:"06:46", iq_fajr:"06:54",
  dhuhr:"13:21", iq_dhuhr:"13:36",
  asr:"16:29", iq_asr:"16:44",
  maghrib:"18:55", iq_maghrib:"18:57",
  isha:"20:03", iq_isha:"20:18"
},

      /* NOVEMBER (30 days) */
{ month:11, from:"11-01", to:"11-07",
  fajr:"06:52", iq_fajr:"07:01",
  dhuhr:"13:21", iq_dhuhr:"13:36",
  asr:"16:21", iq_asr:"16:36",
  maghrib:"18:44", iq_maghrib:"18:46",
  isha:"19:54", iq_isha:"20:09"
},

{ month:11, from:"11-08", to:"11-14",
  fajr:"05:58", iq_fajr:"06:07",
  dhuhr:"12:32", iq_dhuhr:"12:37",
  asr:"15:17", iq_asr:"15:32",
  maghrib:"17:38", iq_maghrib:"17:40",
  isha:"18:49", iq_isha:"19:04"
},

{ month:11, from:"11-15", to:"11-21",
  fajr:"06:03", iq_fajr:"06:14",
  dhuhr:"12:23", iq_dhuhr:"12:38",
  asr:"15:13", iq_asr:"15:28",
  maghrib:"17:34", iq_maghrib:"17:36",
  isha:"18:45", iq_isha:"19:00"
},

{ month:11, from:"11-22", to:"11-30",
  fajr:"06:10", iq_fajr:"06:22",
  dhuhr:"12:26", iq_dhuhr:"12:41",
  asr:"15:11", iq_asr:"15:26",
  maghrib:"17:31", iq_maghrib:"17:33",
  isha:"18:42", iq_isha:"18:57"
},

      /* DECEMBER (31 days) */
{ month:12, from:"12-01", to:"12-07",
  fajr:"06:16", iq_fajr:"06:28",
  dhuhr:"12:29", iq_dhuhr:"12:44",
  asr:"15:10", iq_asr:"15:25",
  maghrib:"17:29", iq_maghrib:"17:31",
  isha:"18:42", iq_isha:"18:57"
},

{ month:12, from:"12-08", to:"12-14",
  fajr:"06:20", iq_fajr:"06:33",
  dhuhr:"12:32", iq_dhuhr:"12:47",
  asr:"15:12", iq_asr:"15:27",
  maghrib:"17:30", iq_maghrib:"17:32",
  isha:"18:44", iq_isha:"18:59"
},

{ month:12, from:"12-15", to:"12-21",
  fajr:"06:24", iq_fajr:"06:37",
  dhuhr:"12:35", iq_dhuhr:"12:50",
  asr:"15:15", iq_asr:"15:30",
  maghrib:"17:33", iq_maghrib:"17:35",
  isha:"18:47", iq_isha:"19:02"
},

{ month:12, from:"12-22", to:"12-31",
  fajr:"06:27", iq_fajr:"06:40",
  dhuhr:"12:40", iq_dhuhr:"12:55",
  asr:"15:20", iq_asr:"15:35",
  maghrib:"17:39", iq_maghrib:"17:41",
  isha:"18:52", iq_isha:"19:07"
}
    ];

    // Convert "HH:MM" (24‑hour) → "h:MM AM/PM"
    function to12Hour(timeStr) {
      const [hour, minute] = timeStr.split(":").map(Number);
      const suffix = hour >= 12 ? "PM" : "AM";
      const h12 = hour % 12 || 12;
      return `${h12}:${minute.toString().padStart(2,"0")} ${suffix}`;
    }

    function isFriday(dateObj) {
      // 5 = Friday (0=Sun,1=Mon,...)
      return dateObj.getDay() === 5;
    }

    function applyFridayJumuahOverride(now, prayerObj) {
      // If it's Friday and this is Dhuhr, override to Jumu'ah with fixed times.
      if (!isFriday(now)) return prayerObj;
      if (prayerObj.name !== "Dhuhr") return prayerObj;

      // Jumu'ah prayer time (iqamah/base) 2:30 PM
      const iqamahStr = "13:45";
      // Khutbah start time shown as the "secondary" line 1:45 PM
      const khutbahStr = "14:30";

      // Build a new Date for 2:30 PM today (used for next-prayer detection + countdown)
      const [h, m] = iqamahStr.split(":").map(Number);
      const dt = new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, m, 0, 0);

      return {
        ...prayerObj,
        // Internal canonical name stays Dhuhr, but displayName changes
        displayName: "Jumu'ah Khutbah",
        // Secondary line becomes khutbah start instead of adhan
        secondaryLabel: "Jumu'ah Salat is Around",
        secondaryTimeStr: khutbahStr,
        // Base prayer time becomes 2:30 PM
        iqamahStr,
        // Keep adhanStr as the khutbah time so older code paths don't show "Adhan"
        adhanStr: khutbahStr,
        date: dt
      };
    }


    let prayerSchedule = []; // Will store today's prayers as Date objects

    async function loadPrayerTimes() {
      const methodText = document.getElementById("methodText");
      const listEl = document.getElementById("prayerList");

      methodText.textContent = "";
      listEl.innerHTML = "";

      const now = new Date();
      const mm = now.getMonth() + 1;
      const dd = now.getDate();

      const key = `${String(mm).padStart(2,"0")}-${String(dd).padStart(2,"0")}`;
      const todayEntry = PRAYER_SCHEDULE.find(e => key >= e.from && key <= e.to);

      if (!todayEntry) {
        listEl.innerHTML = "<div style='color:red;'>No schedule entry found.</div>";
        return;
      }

      const prayersToShow = ["Fajr", "Dhuhr", "Asr", "Maghrib", "Isha"];
      prayerSchedule = [];

      prayersToShow.forEach((name) => {
        const adhanStr = todayEntry[name.toLowerCase()] || "";
        const iqKey = "iq_" + name.toLowerCase();
        const iqamahStr = todayEntry[iqKey] || "";

        // Use iqamah time as the base (actual prayer time). If missing, fall back to adhan.
        const baseStr = iqamahStr || adhanStr;
        if (!baseStr) return;

        const [hour, minute] = baseStr.split(":").map(Number);
        const dt = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hour, minute, 0, 0);

        // Store both canonical name + display fields so Friday can override Dhuhr.
        const basePrayer = {
          name,
          displayName: name,
          adhanStr,
          iqamahStr,
          date: dt,
          // Default secondary line is Adhan
          secondaryLabel: "Adhan",
          secondaryTimeStr: adhanStr
        };

        const finalPrayer = applyFridayJumuahOverride(now, basePrayer);
        prayerSchedule.push(finalPrayer);
      });

      listEl.innerHTML = "";
      prayerSchedule.forEach((p) => {
        const row = document.createElement("div");
        row.className = "prayer-row";

        const label = document.createElement("div");
        label.className = "prayer-row-label";
        label.textContent = p.displayName || p.name;

        const time = document.createElement("div");
        time.className = "prayer-row-time";

        // Main displayed time = iqamah (actual prayer), fall back to adhan if needed
        const mainStr = p.iqamahStr || p.adhanStr;
        const main12 = to12Hour(mainStr);

        // Secondary line: Adhan for normal days, Khutbah start for Friday Jumu'ah
        const secondaryLabel = p.secondaryLabel || "Adhan";
        const secondaryTimeStr = p.secondaryTimeStr || p.adhanStr || "";
        const secondary12 = secondaryTimeStr ? to12Hour(secondaryTimeStr) : "";

        if (secondary12) {
          time.innerHTML = `${main12}<br><span class="iqamah-label">${secondaryLabel} ${secondary12}</span>`;
        } else {
          time.textContent = main12;
        }

        row.appendChild(label);
        row.appendChild(time);
        listEl.appendChild(row);
      });

      updateNextPrayerHighlight();
    }

    function updateNextPrayerHighlight() {
  if (!prayerSchedule || prayerSchedule.length === 0) return;

  const now = new Date();
  const ONE_HOUR = 30 * 60 * 1000; // currently used as a 30-minute window
  let nextPrayer = null;
  let wrapToTomorrow = false;

  // Determine the next upcoming prayer (today)
  for (const p of prayerSchedule) {
    if (p.date > now) {
      nextPrayer = p;
      break;
    }
  }

  // If all prayers are past, treat the first prayer as tomorrow's Fajr
  if (!nextPrayer) {
    nextPrayer = prayerSchedule[0];
    wrapToTomorrow = true;
  }

  // Separate date object for countdown so we can move it to tomorrow if needed
  const nextPrayerDate = new Date(nextPrayer.date);
  if (wrapToTomorrow) {
    nextPrayerDate.setDate(nextPrayerDate.getDate() + 1);
  }

      const rows = document.querySelectorAll(".prayer-row");

      // Remove old highlights
      rows.forEach((row) => {
        row.classList.remove("next");
        row.classList.remove("current-glow");
      });

      // Add "next" border highlight to the upcoming prayer
      rows.forEach((row) => {
        const label = row.querySelector(".prayer-row-label");
        const nextLabel = nextPrayer.displayName || nextPrayer.name;
        if (label && label.textContent === nextLabel) {
          row.classList.add("next");
        }
      });

      // Add glow to the CURRENT prayer row if within ±1 hour of its time
      rows.forEach((row, index) => {
        const p = prayerSchedule[index];
        if (!p) return;
        const diff = now - p.date; // positive if now is after the prayer time
        if (Math.abs(diff) <= ONE_HOUR) {
          row.classList.add("current-glow");
        }
      });

        // Update the next prayer panel at the bottom (main = iqamah, secondary = Adhan/Khutbah)
  const nextPanel = document.getElementById("nextPrayerPanel");
  if (nextPanel) {
    const displayName = nextPrayer.displayName || nextPrayer.name;

    const mainStr = nextPrayer.iqamahStr || nextPrayer.adhanStr;
    const main12 = to12Hour(mainStr);

    const secondaryLabel = nextPrayer.secondaryLabel || "Adhan";
    const secondaryTimeStr = nextPrayer.secondaryTimeStr || nextPrayer.adhanStr || "";
    const secondary12 = secondaryTimeStr ? to12Hour(secondaryTimeStr) : "";

    if (secondary12) {
      nextPanel.innerHTML = `${displayName} at ${main12}<br><span class="iqamah-label">${secondaryLabel} ${secondary12}</span>`;
    } else {
      nextPanel.textContent = `${displayName} at ${main12}`;
    }
  }

  // Update the countdown to next prayer (HH:MM:SS)
  const countdownEl = document.getElementById("nextPrayerCountdown");
  if (countdownEl) {
    let diffMs = nextPrayerDate - now;
    if (diffMs < 0) diffMs = 0;

    const totalSeconds = Math.floor(diffMs / 1000);
    const hours = Math.floor(totalSeconds / 3600);
    const minutes = Math.floor((totalSeconds % 3600) / 60);
    const seconds = totalSeconds % 60;

    const pad = (n) => String(n).padStart(2, "0");
    countdownEl.textContent = `${pad(hours)}:${pad(minutes)}:${pad(seconds)}`;
  }
}

    // Load once on page load
    loadPrayerTimes();
    // Refresh times every 6 hours (more than enough)
    setInterval(loadPrayerTimes, 6 * 60 * 60 * 1000);
    // Update highlight and countdown every second
setInterval(updateNextPrayerHighlight, 1000);

    /****************************************
     * SLIDESHOW
     ****************************************/

    let currentSlideIndex = 0;
    const slideImageEl = document.getElementById("slideImage");
    const dotsContainer = document.getElementById("slideDots");

    function initSlideshow() {
      if (!SLIDES || SLIDES.length === 0) {
        slideImageEl.alt = "No slides configured";
        return;
      }

      // Create dots
      dotsContainer.innerHTML = "";
      SLIDES.forEach((_, index) => {
        const dot = document.createElement("div");
        dot.className = "dot" + (index === 0 ? " active" : "");
        dotsContainer.appendChild(dot);
      });

      // Show first slide
      slideImageEl.src = SLIDES[0];
    }

    function showSlide(nextIndex) {
      if (!SLIDES || SLIDES.length === 0) return;

      currentSlideIndex =
        (nextIndex + SLIDES.length) % SLIDES.length;

      // Fade effect
      slideImageEl.classList.add("fade-out");
      setTimeout(() => {
        slideImageEl.src = SLIDES[currentSlideIndex];
        slideImageEl.classList.remove("fade-out");
        updateDots();
      }, 300);
    }

    function updateDots() {
      const dots = dotsContainer.querySelectorAll(".dot");
      dots.forEach((dot, index) => {
        dot.classList.toggle("active", index === currentSlideIndex);
      });
    }

    function startSlideshow() {
      if (!SLIDES || SLIDES.length === 0) return;
      initSlideshow();
      setInterval(() => {
        showSlide(currentSlideIndex + 1);
      }, SLIDE_DURATION);
    }

    function initQuranWidget() {
      const ayahEl = document.getElementById("quranAyah");
      const refEl = document.getElementById("quranRef");
      if (!ayahEl || !refEl || !QURAN_VERSES.length) return;

      let index = 0;

      function showVerse(i) {
        const verse = QURAN_VERSES[i];
        ayahEl.textContent = verse.text;
        refEl.textContent = verse.ref;
      }

      showVerse(index);

      setInterval(() => {
        index = (index + 1) % QURAN_VERSES.length;
        showVerse(index);
      }, 20000); // change verse every 20 seconds
    }

    // Set masjid name from config
    document.getElementById("masjidName").textContent = MASJID_NAME;

    // Start slideshow
    startSlideshow();

    // Start rotating Qur'an verses
    initQuranWidget();
  </script>
</body>
</html>